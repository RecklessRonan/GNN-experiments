Loading cora dataset...
x
tensor([[-0.1433,  0.1241,  0.0610,  ...,  0.1037, -0.0633, -0.0476],
        [-0.1386,  0.1239,  0.0718,  ...,  0.0930, -0.0663, -0.0456],
        [-0.1562,  0.1237,  0.0468,  ...,  0.1012, -0.0610, -0.0255],
        ...,
        [-0.1575,  0.1288,  0.0572,  ...,  0.1128, -0.0611, -0.0327],
        [-0.1516,  0.1175,  0.0525,  ...,  0.1044, -0.0562, -0.0267],
        [-0.1356,  0.1357,  0.0738,  ...,  0.1065, -0.0693, -0.0520]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.1433,  0.1241,  0.0610,  ...,  0.1037, -0.0633, -0.0476],
        [-0.1386,  0.1239,  0.0718,  ...,  0.0930, -0.0663, -0.0456],
        [-0.1562,  0.1237,  0.0468,  ...,  0.1012, -0.0610, -0.0255],
        ...,
        [-0.1575,  0.1288,  0.0572,  ...,  0.1128, -0.0611, -0.0327],
        [-0.1516,  0.1175,  0.0525,  ...,  0.1044, -0.0562, -0.0267],
        [-0.1356,  0.1357,  0.0738,  ...,  0.1065, -0.0693, -0.0520]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 56.8206, -48.3980, -23.5038,  52.6189, -40.6308,  25.1537,  14.2815],
        [-48.3980,  41.7165,  20.3514, -45.1540,  34.5695, -21.4620, -12.4141],
        [-23.5038,  20.3514,  10.1668, -21.9537,  16.7364, -10.4317,  -6.1340],
        [ 52.6189, -45.1540, -21.9537,  49.1785, -37.7463,  23.3988,  13.3711],
        [-40.6308,  34.5695,  16.7364, -37.7463,  29.4950, -18.1385, -10.2059],
        [ 25.1537, -21.4620, -10.4317,  23.3988, -18.1385,  11.3491,   6.3904],
        [ 14.2815, -12.4141,  -6.1340,  13.3711, -10.2059,   6.3904,   3.8093]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[-15.9208,  24.1103, -34.6931, -14.9428,  54.0943, -31.7079, -10.9190],
        [ 13.5515, -20.6747,  29.4835,  12.8214, -46.6169,  26.5448,   9.2760],
        [  6.5541, -10.1528,  14.3382,   6.1985, -22.8230,  12.6777,   4.5468],
        [-14.8841,  22.3189, -32.3269, -13.9097,  50.3523, -29.4663, -10.3336],
        [ 11.2983, -17.2731,  24.7374,  10.7349, -39.0328,  22.1648,   7.3707],
        [ -7.1155,  10.6806, -15.5591,  -6.6451,  23.9245, -14.1754,  -4.9567],
        [ -4.1235,   6.0686,  -8.9405,  -3.7576,  13.6333,  -8.1635,  -3.1060]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[-5193.7764,  4431.0801,  2143.2939, -4829.4121,  3745.8347, -2316.4797,
         -1309.9738],
        [ 4446.5498, -3793.6289, -1834.9987,  4134.6343, -3206.9534,  1983.1318,
          1121.5115],
        [ 2164.0867, -1846.3457,  -893.0921,  2012.2902, -1560.8022,   965.1387,
           545.8361],
        [-4832.6416,  4122.9487,  1994.2456, -4493.5918,  3485.3889, -2155.4119,
         -1218.8856],
        [ 3710.1179, -3165.2141, -1530.9492,  3449.8240, -2675.9001,  1654.6879,
           935.6671],
        [-2304.6116,  1966.1600,   950.9917, -2142.9216,  1662.1177, -1027.8962,
          -581.2615],
        [-1319.2255,  1125.5083,   544.4025, -1226.6639,   951.4207,  -588.4091,
          -332.7677]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[-53314.6328,  45485.3984,  22001.0469,  ...,  38451.6875,
         -23778.5312, -13446.8877],
        [-52465.4922,  44761.0000,  21650.7168,  ...,  37839.2344,
         -23399.8281, -13232.7373],
        [-52882.2656,  45116.4688,  21822.5410,  ...,  38139.8125,
         -23585.6719, -13337.7236],
        ...,
        [-55269.1758,  47152.8789,  22807.5703,  ...,  39861.3594,
         -24650.2246, -13939.7607],
        [-52078.4727,  44430.6992,  21490.8672,  ...,  37560.1367,
         -23227.1582, -13134.9951],
        [-55018.8047,  46939.4102,  22704.3789,  ...,  39680.8203,
         -24538.6152, -13876.7393]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[ 20860744.0000, -17797346.0000,  -8608480.0000,  19397276.0000,
         -15045228.0000,   9303970.0000,   5261424.5000],
        [-17864470.0000,  15241080.0000,   7372027.5000, -16611201.0000,
          12884249.0000,  -7967621.0000,  -4505716.0000],
        [ -8697905.0000,   7420623.0000,   3589317.0000,  -8087712.5000,
           6273121.0000,  -3879298.7500,  -2193758.2500],
        [ 19417216.0000, -16565797.0000,  -8012788.0000,  18055012.0000,
         -14004120.0000,   8660151.0000,   4897342.5000],
        [-14961596.0000,  12764488.0000,   6174112.5000, -13911974.0000,
          10790636.0000,  -6672930.0000,  -3773561.5000],
        [  9272288.0000,  -7910653.0000,  -3826340.7500,   8621798.0000,
          -6687380.0000,   4135476.0000,   2338624.5000],
        [  5297753.5000,  -4519780.5000,  -2186194.5000,   4926093.0000,
          -3820856.7500,   2362818.2500,   1336182.3750]],
       grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[-6863399.0000,  5855510.0000,  2832278.5000,  ...,
          4950034.5000, -3061101.2500, -1731062.8750],
        [-6753991.5000,  5762169.0000,  2787130.5000,  ...,
          4871127.0000, -3012305.7500, -1703468.5000],
        [-6807662.0000,  5807958.0000,  2809277.7500,  ...,
          4909836.0000, -3036243.0000, -1717005.1250],
        ...,
        [-7115070.5000,  6070224.0000,  2936134.7500,  ...,
          5131546.0000, -3173348.5000, -1794538.7500],
        [-6704493.0000,  5719939.5000,  2766703.5000,  ...,
          4835428.0000, -2990229.0000, -1690984.1250],
        [-7082918.0000,  6042793.0000,  2922866.2500,  ...,
          5108357.0000, -3159008.0000, -1786429.0000]], grad_fn=<AddBackward0>)
x
tensor([[-0.0938,  0.1009,  0.0795,  ...,  0.0598, -0.0471, -0.0248],
        [-0.0919,  0.1025,  0.0824,  ...,  0.0596, -0.0470, -0.0273],
        [-0.0935,  0.1053,  0.0835,  ...,  0.0665, -0.0468, -0.0274],
        ...,
        [-0.0940,  0.1039,  0.0878,  ...,  0.0613, -0.0457, -0.0289],
        [-0.0952,  0.1031,  0.0856,  ...,  0.0624, -0.0452, -0.0270],
        [-0.0937,  0.1055,  0.0840,  ...,  0.0642, -0.0450, -0.0307]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.0938,  0.1009,  0.0795,  ...,  0.0598, -0.0471, -0.0248],
        [-0.0919,  0.1025,  0.0824,  ...,  0.0596, -0.0470, -0.0273],
        [-0.0935,  0.1053,  0.0835,  ...,  0.0665, -0.0468, -0.0274],
        ...,
        [-0.0940,  0.1039,  0.0878,  ...,  0.0613, -0.0457, -0.0289],
        [-0.0952,  0.1031,  0.0856,  ...,  0.0624, -0.0452, -0.0270],
        [-0.0937,  0.1055,  0.0840,  ...,  0.0642, -0.0450, -0.0307]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 23.8375, -26.2117, -21.0140,  29.3289, -15.7132,  11.7745,   6.9578],
        [-26.2117,  28.8634,  23.1341, -32.2835,  17.2847, -12.9531,  -7.6661],
        [-21.0140,  23.1341,  18.5576, -25.8779,  13.8594, -10.3859,  -6.1480],
        [ 29.3289, -32.2835, -25.8779,  36.1348, -19.3445,  14.4988,   8.5710],
        [-15.7132,  17.2847,  13.8594, -19.3445,  10.3830,  -7.7689,  -4.5909],
        [ 11.7745, -12.9531, -10.3859,  14.4988,  -7.7689,   5.8280,   3.4415],
        [  6.9578,  -7.6661,  -6.1480,   8.5710,  -4.5909,   3.4415,   2.0456]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[ -7.1142,  12.3592, -19.7323,  -4.6201,  27.9153, -12.2569,  -8.8978],
        [  7.6933, -13.7100,  21.4413,   5.1519, -31.0496,  12.9058,   9.4138],
        [  6.1529, -11.0061,  17.1678,   4.1329, -24.9261,  10.2855,   7.5109],
        [ -8.7500,  15.2196, -24.2696,  -5.6978,  34.4104, -15.0249, -10.9236],
        [  4.5827,  -8.2380,  12.8035,   3.0984, -18.6731,   7.6205,   5.5550],
        [ -3.5503,   6.0789,  -9.8223,  -2.2680,  13.7160,  -6.1929,  -4.4935],
        [ -2.1279,   3.5694,  -5.8619,  -1.3257,   8.0472,  -3.7699,  -2.7424]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ -859.2537,   945.3472,   757.6792, -1057.9442,   567.2245,  -424.8306,
          -251.0711],
        [  948.6313, -1043.6854,  -836.4974,  1167.9927,  -626.2288,   469.0158,
           277.1855],
        [  760.6431,  -836.8610,  -670.7311,   936.5344,  -502.1308,   376.0715,
           222.2561],
        [-1058.2362,  1164.2671,   933.1398, -1302.9387,   698.5804,  -523.2106,
          -309.2130],
        [  568.7848,  -625.7784,  -501.5518,   700.3110,  -375.4779,   281.2138,
           166.1956],
        [ -423.7841,   466.2441,   373.6859,  -521.7773,   279.7546,  -209.5276,
          -123.8287],
        [ -249.9012,   274.9383,   220.3575,  -307.6859,   164.9679,  -123.5572,
           -73.0209]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[-8436.9414,  9282.2988,  7439.6030,  ...,  5569.5356, -4171.3594,
         -2465.2300],
        [-8507.5293,  9359.9746,  7501.8638,  ...,  5616.1377, -4206.2627,
         -2485.8674],
        [-8636.3096,  9501.6621,  7615.4209,  ...,  5701.1738, -4269.9287,
         -2523.4949],
        ...,
        [-8620.4932,  9484.2529,  7601.4888,  ...,  5690.7100, -4262.1035,
         -2518.8787],
        [-8534.2568,  9389.3662,  7525.4331,  ...,  5633.7842, -4219.4624,
         -2493.6714],
        [-8604.2979,  9466.4434,  7587.1943,  ...,  5680.0317, -4254.0942,
         -2514.1538]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[ 2160790.7500, -2377298.2500, -1905364.8750,  2660447.0000,
         -1426419.3750,  1068329.0000,   631374.2500],
        [-2378104.7500,  2616386.7500,  2096989.6250, -2928012.5000,
          1569876.8750, -1175772.2500,  -694872.4375],
        [-1906554.1250,  2097587.5000,  1681181.3750, -2347421.7500,
          1258588.2500,  -942630.1250,  -557087.2500],
        [ 2660883.0000, -2927499.0000, -2346341.5000,  3276180.5000,
         -1756549.6250,  1315582.3750,   777499.1875],
        [-1425201.0000,  1568003.6250,  1256729.0000, -1754761.5000,
           940829.1250,  -704641.6250,  -416437.9375],
        [ 1067984.0000, -1174994.2500,  -941738.1250,  1314942.3750,
          -705016.5625,   528028.1250,   312060.5938],
        [  631594.0000,  -694878.6250,  -556933.6875,   777642.2500,
          -416938.9375,   312269.9375,   184549.2344]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[-678841.1250,  746859.8125,  598595.6250,  ...,  448128.6875,
         -335629.6875, -198354.6406],
        [-684528.3125,  753116.8750,  603610.5000,  ...,  451883.0312,
         -338441.5625, -200016.3750],
        [-694847.0000,  764469.6250,  612709.5625,  ...,  458694.8438,
         -343543.3125, -203031.4844],
        ...,
        [-693581.0625,  763076.7500,  611593.2500,  ...,  457859.0625,
         -342917.3438, -202661.5625],
        [-686649.4375,  755450.5625,  605481.0000,  ...,  453283.2500,
         -339490.3125, -200636.1719],
        [-692283.7500,  761649.2500,  610449.2500,  ...,  457002.6562,
         -342275.9375, -202282.4688]], grad_fn=<AddBackward0>)
Epoch: 0001 loss_train: 4618130.5000 acc_train: 0.2929 loss_val: 528410.5625 acc_val: 0.3500 time: 0.0716s
x
tensor([[-0.1097,  0.1074,  0.0948,  ...,  0.0649, -0.0587, -0.0417],
        [-0.1120,  0.0844,  0.0709,  ...,  0.0790, -0.0441, -0.0117],
        [-0.1071,  0.0997,  0.0600,  ...,  0.0745, -0.0648, -0.0340],
        ...,
        [-0.0872,  0.1242,  0.0891,  ...,  0.0516, -0.0424, -0.0200],
        [-0.0965,  0.1069,  0.0986,  ...,  0.0818, -0.0436, -0.0299],
        [-0.0776,  0.0952,  0.0879,  ...,  0.0853, -0.0515, -0.0270]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.1097,  0.1074,  0.0948,  ...,  0.0649, -0.0587, -0.0417],
        [-0.1120,  0.0844,  0.0709,  ...,  0.0790, -0.0441, -0.0117],
        [-0.1071,  0.0997,  0.0600,  ...,  0.0745, -0.0648, -0.0340],
        ...,
        [-0.0872,  0.1242,  0.0891,  ...,  0.0516, -0.0424, -0.0200],
        [-0.0965,  0.1069,  0.0986,  ...,  0.0818, -0.0436, -0.0299],
        [-0.0776,  0.0952,  0.0879,  ...,  0.0853, -0.0515, -0.0270]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 24.4707, -26.1246, -20.9560,  29.4720, -15.9510,  11.7907,   6.9872],
        [-26.1246,  29.3276,  23.2985, -32.0209,  16.7781, -12.6900,  -7.8489],
        [-20.9560,  23.2985,  19.2915, -25.5953,  13.8026, -10.3266,  -6.3891],
        [ 29.4720, -32.0209, -25.5953,  36.5795, -19.5769,  14.6505,   8.3896],
        [-15.9510,  16.7781,  13.8026, -19.5769,  11.6624,  -8.3911,  -4.5322],
        [ 11.7907, -12.6900, -10.3266,  14.6505,  -8.3911,   6.3471,   3.5039],
        [  6.9872,  -7.8489,  -6.3891,   8.3896,  -4.5322,   3.5039,   2.4503]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[ -7.1068,  12.4823, -19.8968,  -4.6645,  28.1592, -12.4556,  -8.7212],
        [  7.7085, -13.7619,  21.2217,   5.1427, -30.9575,  12.9538,   9.7369],
        [  6.1244, -11.2496,  17.2880,   3.9381, -25.0916,  10.0072,   7.8153],
        [ -8.7795,  15.1157, -24.3999,  -5.7969,  34.5019, -15.1594, -10.6842],
        [  4.5850,  -8.2815,  13.3499,   3.0683, -18.9664,   7.4416,   5.1018],
        [ -3.5470,   6.0901, -10.1757,  -2.2978,  13.8005,  -6.0387,  -4.2983],
        [ -2.1232,   3.6313,  -5.9844,  -1.2883,   8.0731,  -3.6180,  -2.9730]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ -877.4814,   936.5035,   748.3137, -1077.4242,   611.9254,  -450.9678,
          -252.2741],
        [  969.5708, -1035.4398,  -827.6747,  1190.3157,  -675.4862,   497.8268,
           278.9857],
        [  770.3704,  -822.5596,  -657.3298,   945.6765,  -536.9344,   395.5848,
           221.6068],
        [-1072.9874,  1144.9181,   914.8444, -1317.4645,   748.3619,  -551.4595,
          -308.3911],
        [  565.1362,  -602.5687,  -481.2499,   693.9777,  -394.6456,   290.5025,
           162.0184],
        [ -421.7428,   449.6847,   359.0340,  -517.8521,   294.3906,  -216.8794,
          -121.0854],
        [ -251.5860,   268.4865,   214.4088,  -308.7974,   175.3981,  -129.3134,
           -72.4603]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[-9373.4551, 10004.1846,  7993.9102,  ...,  6535.9180, -4815.9854,
         -2694.7515],
        [-8866.5283,  9462.4678,  7560.9526,  ...,  6183.0303, -4555.7451,
         -2548.5278],
        [-8950.8672,  9552.5908,  7632.7979,  ...,  6241.7314, -4599.1646,
         -2572.9612],
        ...,
        [-9088.4355,  9700.5762,  7751.5400,  ...,  6336.7866, -4669.3042,
         -2612.9084],
        [-8616.6533,  9196.6221,  7348.6855,  ...,  6008.2935, -4426.9531,
         -2477.0601],
        [-8548.1338,  9123.0605,  7289.7588,  ...,  5960.9297, -4392.0220,
         -2457.1760]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[ 2206382.7500, -2354856.7500, -1881675.1250,  2708935.5000,
         -1538471.8750,  1133608.1250,   634286.8750],
        [-2409585.7500,  2571763.2500,  2055004.0000, -2958418.7500,
          1680139.2500, -1237999.6250,  -692717.0000],
        [-1941403.8750,  2072065.0000,  1655713.5000, -2383597.2500,
          1353694.5000,  -997457.5000,  -558119.9375],
        [ 2704678.0000, -2886681.0000, -2306633.0000,  3320734.2500,
         -1885929.1250,  1389627.8750,   777533.3750],
        [-1463525.3750,  1561983.5000,  1248110.5000, -1796881.5000,
          1020518.3125,  -751949.5625,  -420716.6250],
        [ 1092557.8750, -1166065.7500,  -931751.6250,  1341416.1250,
          -761836.0000,   561348.0000,   314079.5938],
        [  646439.8125,  -689948.6250,  -551312.4375,   793677.7500,
          -450744.7500,   332128.4688,   185843.2812]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[-757209.1875,  808165.5625,  645774.0000,  ...,  527988.1875,
         -389042.9062, -217681.6719],
        [-716680.0625,  764908.1875,  611208.3750,  ...,  499728.9688,
         -368220.0625, -206029.9062],
        [-723575.1875,  772267.3750,  617088.8750,  ...,  504536.5625,
         -371762.6875, -208012.1875],
        ...,
        [-733123.4375,  782459.5000,  625233.4375,  ...,  511193.1875,
         -376667.7500, -210757.7812],
        [-696258.5000,  743113.1250,  593793.0625,  ...,  485488.6562,
         -357727.3438, -200159.5938],
        [-691311.2500,  737832.5000,  589573.3750,  ...,  482039.3750,
         -355185.7500, -198737.0938]], grad_fn=<AddBackward0>)
x
tensor([[-0.0543,  0.0815,  0.0980,  ...,  0.0277, -0.0318, -0.0152],
        [-0.0526,  0.0826,  0.1002,  ...,  0.0281, -0.0315, -0.0169],
        [-0.0539,  0.0860,  0.1019,  ...,  0.0344, -0.0318, -0.0180],
        ...,
        [-0.0545,  0.0846,  0.1062,  ...,  0.0291, -0.0305, -0.0195],
        [-0.0556,  0.0838,  0.1042,  ...,  0.0301, -0.0300, -0.0174],
        [-0.0542,  0.0861,  0.1025,  ...,  0.0320, -0.0299, -0.0212]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.0543,  0.0815,  0.0980,  ...,  0.0277, -0.0318, -0.0152],
        [-0.0526,  0.0826,  0.1002,  ...,  0.0281, -0.0315, -0.0169],
        [-0.0539,  0.0860,  0.1019,  ...,  0.0344, -0.0318, -0.0180],
        ...,
        [-0.0545,  0.0846,  0.1062,  ...,  0.0291, -0.0305, -0.0195],
        [-0.0556,  0.0838,  0.1042,  ...,  0.0301, -0.0300, -0.0174],
        [-0.0542,  0.0861,  0.1025,  ...,  0.0320, -0.0299, -0.0212]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[  7.9756, -12.2953, -14.8503,  14.2990,  -4.3533,   4.5602,   2.5981],
        [-12.2953,  19.0191,  22.9594, -22.1061,   6.7166,  -7.0423,  -4.0257],
        [-14.8503,  22.9594,  27.7398, -26.6946,   8.1150,  -8.5088,  -4.8617],
        [ 14.2990, -22.1061, -26.6946,  25.7214,  -7.8155,   8.1955,   4.6746],
        [ -4.3533,   6.7166,   8.1150,  -7.8155,   2.4003,  -2.4957,  -1.4215],
        [  4.5602,  -7.0423,  -8.5088,   8.1955,  -2.4957,   2.6207,   1.4912],
        [  2.5981,  -4.0257,  -4.8617,   4.6746,  -1.4215,   1.4912,   0.8621]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[ -2.8069,   6.0689,  -9.7932,  -0.4458,  13.0452,  -3.5545,  -5.9834],
        [  4.1920,  -9.5290,  14.7808,   0.7901, -20.5754,   4.8038,   8.8080],
        [  5.0725, -11.5002,  17.8850,   0.9419, -24.8178,   5.8499,  10.6735],
        [ -5.0036,  10.9423, -17.4921,  -0.8338,  23.5744,  -6.1665, -10.6255],
        [  1.4437,  -3.4099,   5.1438,   0.3034,  -7.3859,   1.5232,   2.9884],
        [ -1.6338,   3.4479,  -5.6736,  -0.2388,   7.4016,  -2.1456,  -3.5067],
        [ -0.9591,   1.9377,  -3.2981,  -0.1170,   4.1539,  -1.3348,  -2.0869]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ -46.4929,   71.6848,   86.4557,  -83.3923,   25.6828,  -26.6579,
          -15.2001],
        [  76.7561, -118.3689, -142.7729,  137.6965,  -42.3772,   44.0035,
           25.0922],
        [  92.1730, -142.1419, -171.4457,  165.3515,  -50.8915,   52.8423,
           30.1323],
        [ -84.9597,  131.0010,  157.9983, -152.3948,   46.9256,  -48.7118,
          -27.7756],
        [  28.2547,  -43.5776,  -52.5648,   50.6922,  -15.5948,   16.1965,
            9.2360],
        [ -25.7001,   39.6212,   47.7828,  -46.0930,   14.2013,  -14.7370,
           -8.4026],
        [ -13.7624,   21.2129,   25.5799,  -24.6785,    7.6093,   -7.8928,
           -4.5000]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[-562.4799,  867.3505, 1046.1311,  ...,  310.6044, -322.4849,
         -183.8747],
        [-568.3801,  876.4641, 1057.1271,  ...,  313.8673, -325.8701,
         -185.8123],
        [-578.5660,  892.1785, 1076.0723,  ...,  319.5128, -331.7076,
         -189.1450],
        ...,
        [-581.8633,  897.2534, 1082.2166,  ...,  321.3119, -333.5917,
         -190.2280],
        [-572.6210,  882.9915, 1065.0112,  ...,  316.2090, -328.2879,
         -187.1969],
        [-576.9166,  889.6334, 1073.0039,  ...,  318.5919, -330.7538,
         -188.6183]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[  83514.6719, -128782.1172, -155327.4062,  149811.7656,  -46118.1875,
           47880.7070,   27302.4004],
        [-129089.2422,  199059.6875,  240090.9844, -231565.3594,   71285.2500,
          -74009.6016,  -42201.5938],
        [-155907.3438,  240414.0312,  289969.5625, -279672.7188,   86094.6484,
          -89384.9922,  -50968.9180],
        [ 150120.5781, -231490.5938, -279206.7500,  269292.1875,  -82899.1094,
           86067.3203,   49077.0781],
        [ -45646.3984,   70388.1406,   84896.9453,  -81882.2656,   25206.7969,
          -26170.0625,  -14922.6143],
        [  47848.6367,  -73784.0781,  -88992.8672,   85832.7812,  -26422.8398,
           27432.6738,   15642.5752],
        [  27318.6426,  -42126.2383,  -50809.5352,   49005.2656,  -15085.8223,
           15662.3691,    8931.0020]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[-31120.7617,  47989.1836,  57880.9805,  ...,  17185.4082,
         -17842.1934, -10173.9316],
        [-31442.1152,  48484.7344,  58478.6758,  ...,  17362.8691,
         -18026.4336, -10278.9893],
        [-31982.5156,  49318.0234,  59483.7383,  ...,  17661.2852,
         -18336.2539, -10455.6543],
        ...,
        [-32170.7500,  49608.2969,  59833.8477,  ...,  17765.2324,
         -18444.1738, -10517.1943],
        [-31654.4941,  48812.2031,  58873.6523,  ...,  17480.1426,
         -18148.1914, -10348.4180],
        [-31896.4590,  49185.3359,  59323.6992,  ...,  17613.7637,
         -18286.9180, -10427.5234]], grad_fn=<AddBackward0>)
Epoch: 0002 loss_train: 542879.4375 acc_train: 0.2929 loss_val: 40763.8906 acc_val: 0.1567 time: 0.0192s
x
tensor([[-0.0701,  0.0576,  0.0758,  ...,  0.0163, -0.0346,  0.0024],
        [-0.0324,  0.0598,  0.0997,  ...,  0.0767, -0.0443,  0.0237],
        [-0.0683,  0.0877,  0.0805,  ...,  0.0453, -0.0133, -0.0276],
        ...,
        [-0.0303,  0.1295,  0.1275,  ..., -0.0325, -0.0030, -0.0249],
        [-0.0366,  0.0644,  0.1200,  ...,  0.0465, -0.0325, -0.0147],
        [-0.0434,  0.1007,  0.1113,  ...,  0.0516, -0.0293, -0.0485]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.0701,  0.0576,  0.0758,  ...,  0.0163, -0.0346,  0.0024],
        [-0.0324,  0.0598,  0.0997,  ...,  0.0767, -0.0443,  0.0237],
        [-0.0683,  0.0877,  0.0805,  ...,  0.0453, -0.0133, -0.0276],
        ...,
        [-0.0303,  0.1295,  0.1275,  ..., -0.0325, -0.0030, -0.0249],
        [-0.0366,  0.0644,  0.1200,  ...,  0.0465, -0.0325, -0.0147],
        [-0.0434,  0.1007,  0.1113,  ...,  0.0516, -0.0293, -0.0485]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[  9.7705, -12.5429, -15.0292,  14.7356,  -4.9306,   4.5911,   2.8779],
        [-12.5429,  20.2967,  23.4085, -21.8169,   5.8660,  -6.4422,  -4.5554],
        [-15.0292,  23.4085,  29.7515, -26.1974,   8.1888,  -8.4204,  -5.5414],
        [ 14.7356, -21.8169, -26.1974,  26.6715,  -8.1717,   8.3551,   4.4477],
        [ -4.9306,   5.8660,   8.1888,  -8.1717,   5.1093,  -3.6929,  -1.4612],
        [  4.5911,  -6.4422,  -8.4204,   8.3551,  -3.6929,   3.6581,   1.6312],
        [  2.8779,  -4.5554,  -5.5414,   4.4477,  -1.4612,   1.6312,   1.8879]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[-2.8283e+00,  6.5103e+00, -1.0343e+01, -5.4172e-01,  1.3867e+01,
         -4.1190e+00, -5.7549e+00],
        [ 4.3024e+00, -9.7061e+00,  1.4489e+01,  8.1036e-01, -2.0698e+01,
          5.1008e+00,  9.5428e+00],
        [ 5.0079e+00, -1.2190e+01,  1.8418e+01,  4.3134e-01, -2.5474e+01,
          5.1932e+00,  1.1406e+01],
        [-5.0978e+00,  1.0737e+01, -1.7752e+01, -1.0418e+00,  2.3850e+01,
         -6.5276e+00, -1.0271e+01],
        [ 1.4359e+00, -3.5303e+00,  6.3366e+00,  1.5613e-01, -8.0578e+00,
          1.0937e+00,  2.1427e+00],
        [-1.5756e+00,  3.4910e+00, -6.3747e+00, -2.5485e-01,  7.5029e+00,
         -1.7663e+00, -3.0909e+00],
        [-9.7683e-01,  2.0970e+00, -3.7458e+00, -1.3054e-02,  4.4091e+00,
         -1.0251e+00, -2.6359e+00]], grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ -65.6664,   71.4032,   81.4910, -100.5174,   66.3320,  -48.0209,
          -20.7350],
        [ 110.9016, -127.2341, -147.3590,  171.4028, -104.6598,   77.7131,
           36.4937],
        [ 113.6524, -123.3606, -139.5011,  171.0428, -114.9038,   81.7190,
           37.0290],
        [-110.1553,  117.7931,  134.2803, -167.2127,  112.2327,  -80.5076,
          -34.7330],
        [  16.2925,   -8.8123,   -6.8510,   20.8532,  -25.5139,   14.5351,
            3.3979],
        [ -21.1276,   16.4267,   15.8578,  -28.9921,   27.5011,  -17.3854,
           -5.9255],
        [ -13.7747,   11.8921,   12.0121,  -18.6816,   16.7151,  -10.8943,
           -4.7562]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[-724.3034,  781.9048,  889.5280,  ...,  732.8990, -525.6115,
         -230.7934],
        [-675.7548,  720.1447,  814.9476,  ...,  694.2435, -492.6627,
         -213.6443],
        [-656.0839,  710.3533,  807.5739,  ...,  662.6622, -474.7250,
         -209.9868],
        ...,
        [-815.0712,  903.5410, 1034.2434,  ...,  801.8945, -582.3853,
         -265.3622],
        [-724.1356,  778.0067,  882.1567,  ...,  737.4739, -525.6954,
         -231.2191],
        [-763.8743,  824.3040,  935.4271,  ...,  774.3497, -553.2316,
         -244.9239]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[ 111657.2734, -120778.0156, -137279.5469,  169185.1250, -112854.4062,
           80843.9219,   35737.6250],
        [-168703.8438,  183026.9062,  208197.2500, -255803.1562,  169973.6406,
         -121943.2344,  -54120.3984],
        [-204814.3906,  221771.7969,  252090.0312, -310318.8750,  206807.4375,
         -148173.7656,  -65653.2188],
        [ 193528.7344, -209359.6250, -237977.9219,  293248.1562, -195572.5938,
          140106.3438,   61949.7148],
        [ -59750.8750,   63908.1562,   72372.3750,  -90213.2578,   61128.3672,
          -43496.6445,  -18996.9492],
        [  61082.5820,  -65674.5156,  -74492.3438,   92364.6562,  -62137.0703,
           44352.8945,   19492.0430],
        [  37975.3906,  -41112.6484,  -46714.8359,   57510.8984,  -38351.2930,
           27472.4141,   12191.6113]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[-40732.2344,  44076.2500,  50100.3594,  ...,  41152.8242,
         -29482.1484, -13044.3770],
        [-39309.0391,  42508.4648,  48307.0586,  ...,  39743.8164,
         -28460.5000, -12584.3740],
        [-36923.0742,  39958.9336,  45419.9375,  ...,  37300.6914,
         -26722.6289, -11826.8184],
        ...,
        [-43691.9961,  47340.4766,  53829.3203,  ...,  44082.5156,
         -31602.0547, -14006.2490],
        [-41562.9570,  44969.9805,  51111.9141,  ...,  41998.5547,
         -30083.8438, -13311.4902],
        [-43494.3281,  47069.8203,  53501.4258,  ...,  43940.1250,
         -31478.1719, -13932.5098]], grad_fn=<AddBackward0>)
x
tensor([[-0.0209,  0.0650,  0.1172,  ..., -0.0002, -0.0184, -0.0083],
        [-0.0195,  0.0655,  0.1189,  ...,  0.0007, -0.0179, -0.0092],
        [-0.0205,  0.0693,  0.1209,  ...,  0.0068, -0.0186, -0.0111],
        ...,
        [-0.0211,  0.0682,  0.1254,  ...,  0.0013, -0.0172, -0.0127],
        [-0.0222,  0.0672,  0.1235,  ...,  0.0021, -0.0165, -0.0105],
        [-0.0209,  0.0696,  0.1217,  ...,  0.0040, -0.0166, -0.0144]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.0209,  0.0650,  0.1172,  ..., -0.0002, -0.0184, -0.0083],
        [-0.0195,  0.0655,  0.1189,  ...,  0.0007, -0.0179, -0.0092],
        [-0.0205,  0.0693,  0.1209,  ...,  0.0068, -0.0186, -0.0111],
        ...,
        [-0.0211,  0.0682,  0.1254,  ...,  0.0013, -0.0172, -0.0127],
        [-0.0222,  0.0672,  0.1235,  ...,  0.0021, -0.0165, -0.0105],
        [-0.0209,  0.0696,  0.1217,  ...,  0.0040, -0.0166, -0.0144]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 1.1874e+00, -3.7748e+00, -6.7680e+00,  4.6154e+00, -9.9091e-02,
          9.9044e-01,  6.0143e-01],
        [-3.7748e+00,  1.2225e+01,  2.1898e+01, -1.4935e+01,  2.9670e-01,
         -3.1958e+00, -1.9605e+00],
        [-6.7680e+00,  2.1898e+01,  3.9274e+01, -2.6773e+01,  5.3469e-01,
         -5.7354e+00, -3.5108e+00],
        [ 4.6154e+00, -1.4935e+01, -2.6773e+01,  1.8276e+01, -3.6662e-01,
          3.9134e+00,  2.3897e+00],
        [-9.9091e-02,  2.9670e-01,  5.3469e-01, -3.6662e-01,  3.3235e-02,
         -8.2776e-02, -4.7970e-02],
        [ 9.9044e-01, -3.1958e+00, -5.7354e+00,  3.9134e+00, -8.2776e-02,
          8.4645e-01,  5.1296e-01],
        [ 6.0143e-01, -1.9605e+00, -3.5108e+00,  2.3897e+00, -4.7970e-02,
          5.1296e-01,  3.2512e-01]], grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[-7.4787e-01,  2.0693e+00, -3.2844e+00,  5.4833e-01,  4.0604e+00,
         -3.4710e-01, -2.7995e+00],
        [ 2.1985e+00, -6.9612e+00,  1.0004e+01, -1.5813e+00, -1.3836e+01,
         -7.0517e-03,  8.3463e+00],
        [ 3.9801e+00, -1.2433e+01,  1.8057e+01, -2.8768e+00, -2.4674e+01,
          1.8517e-01,  1.5098e+01],
        [-2.8076e+00,  8.3564e+00, -1.2558e+01,  2.0344e+00,  1.6543e+01,
         -5.7385e-01, -1.0586e+01],
        [ 2.2416e-03, -2.3721e-01,  1.1199e-01,  4.2911e-03, -5.1095e-01,
         -2.5688e-01,  2.6964e-02],
        [-6.4231e-01,  1.7385e+00, -2.8074e+00,  4.7154e-01,  3.4099e+00,
         -3.2648e-01, -2.4023e+00],
        [-4.1469e-01,  1.0326e+00, -1.7730e+00,  3.0793e-01,  2.0185e+00,
         -2.9710e-01, -1.5444e+00]], grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ 1.3631e+01, -4.4191e+01, -7.9308e+01,  5.4061e+01, -9.7112e-01,
          1.1564e+01,  7.0514e+00],
        [-3.9737e+01,  1.2886e+02,  2.3128e+02, -1.5765e+02,  2.7861e+00,
         -3.3724e+01, -2.0559e+01],
        [-7.2122e+01,  2.3386e+02,  4.1975e+02, -2.8611e+02,  5.0667e+00,
         -6.1205e+01, -3.7313e+01],
        [ 5.0928e+01, -1.6513e+02, -2.9637e+02,  2.0202e+02, -3.5976e+00,
          4.3214e+01,  2.6347e+01],
        [-2.7609e-02,  9.6439e-02,  1.7910e-01, -1.2021e-01, -9.3098e-03,
         -2.6521e-02, -1.4994e-02],
        [ 1.1746e+01, -3.8078e+01, -6.8337e+01,  4.6582e+01, -8.3891e-01,
          9.9642e+00,  6.0762e+00],
        [ 7.6074e+00, -2.4660e+01, -4.4253e+01,  3.0166e+01, -5.4766e-01,
          6.4525e+00,  3.9352e+00]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[  318.1122, -1031.5002, -1851.3547,  ...,   -22.3941,   269.9489,
           164.5872],
        [  320.9893, -1040.8088, -1868.0592,  ...,   -22.5916,   272.3879,
           166.0692],
        [  325.9579, -1056.9189, -1896.9948,  ...,   -22.9154,   276.6054,
           168.6343],
        ...,
        [  331.7618, -1075.7501, -1930.7659,  ...,   -23.3468,   281.5380,
           171.6319],
        [  325.0034, -1053.8545, -1891.4688,  ...,   -22.8674,   275.8095,
           168.1463],
        [  326.2386, -1057.8325, -1898.6329,  ...,   -22.9466,   276.8528,
           168.7671]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[-1.8107e+04,  5.8712e+04,  1.0538e+05, -7.1829e+04,  1.2741e+03,
         -1.5366e+04, -9.3677e+03],
        [ 5.8578e+04, -1.8994e+05, -3.4091e+05,  2.3238e+05, -4.1220e+03,
          4.9710e+04,  3.0306e+04],
        [ 1.0502e+05, -3.4054e+05, -6.1122e+05,  4.1663e+05, -7.3903e+03,
          8.9124e+04,  5.4335e+04],
        [-7.1626e+04,  2.3225e+05,  4.1685e+05, -2.8414e+05,  5.0402e+03,
         -6.0782e+04, -3.7056e+04],
        [ 1.4339e+03, -4.6494e+03, -8.3449e+03,  5.6882e+03, -1.0079e+02,
          1.2168e+03,  7.4183e+02],
        [-1.5342e+04,  4.9747e+04,  8.9286e+04, -6.0861e+04,  1.0796e+03,
         -1.3019e+04, -7.9372e+03],
        [-9.3877e+03,  3.0440e+04,  5.4634e+04, -3.7241e+04,  6.6059e+02,
         -7.9665e+03, -4.8567e+03]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[ 14697.8711, -47658.3789, -85538.2734,  ...,  -1034.2620,
          12472.7109,   7604.0278],
        [ 14834.0586, -48099.9727, -86330.8438,  ...,  -1043.8431,
          12588.2793,   7674.4844],
        [ 15071.8291, -48870.9492, -87714.6094,  ...,  -1060.5734,
          12790.0518,   7797.4946],
        ...,
        [ 15336.1963, -49728.1719, -89253.1641,  ...,  -1079.1785,
          13014.3965,   7934.2666],
        [ 15028.4873, -48730.4180, -87462.3594,  ...,  -1057.5253,
          12753.2744,   7775.0718],
        [ 15083.2695, -48908.0508, -87781.1953,  ...,  -1061.3801,
          12799.7627,   7803.4131]], grad_fn=<AddBackward0>)
Epoch: 0003 loss_train: 35420.3984 acc_train: 0.2000 loss_val: 81278.6641 acc_val: 0.0833 time: 0.0186s
x
tensor([[-0.0222,  0.0400,  0.0587,  ...,  0.0111, -0.0014,  0.0235],
        [-0.0145,  0.0433,  0.1283,  ..., -0.0249,  0.0050,  0.0055],
        [-0.0413,  0.0848,  0.1595,  ...,  0.0038, -0.0189, -0.0614],
        ...,
        [-0.0901,  0.1292,  0.1232,  ...,  0.0218,  0.0012, -0.0418],
        [-0.0808,  0.0957,  0.1418,  ..., -0.0079,  0.0122, -0.0460],
        [-0.0717,  0.0593,  0.0890,  ...,  0.0093,  0.0002,  0.0077]],
       grad_fn=<AddmmBackward>)
h0
tensor([[-0.0222,  0.0400,  0.0587,  ...,  0.0111, -0.0014,  0.0235],
        [-0.0145,  0.0433,  0.1283,  ..., -0.0249,  0.0050,  0.0055],
        [-0.0413,  0.0848,  0.1595,  ...,  0.0038, -0.0189, -0.0614],
        ...,
        [-0.0901,  0.1292,  0.1232,  ...,  0.0218,  0.0012, -0.0418],
        [-0.0808,  0.0957,  0.1418,  ..., -0.0079,  0.0122, -0.0460],
        [-0.0717,  0.0593,  0.0890,  ...,  0.0093,  0.0002,  0.0077]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 3.9368e+00, -4.2192e+00, -6.5689e+00,  5.2148e+00, -8.4717e-01,
          8.8216e-01,  8.8332e-01],
        [-4.2192e+00,  1.5384e+01,  2.3030e+01, -1.5329e+01, -1.1629e+00,
         -2.1139e+00, -2.7191e+00],
        [-6.5689e+00,  2.3030e+01,  4.2112e+01, -2.5898e+01, -1.5211e-01,
         -4.8999e+00, -4.2765e+00],
        [ 5.2148e+00, -1.5329e+01, -2.5898e+01,  2.0486e+01, -5.5575e-01,
          3.8561e+00,  1.8739e+00],
        [-8.4717e-01, -1.1629e+00, -1.5211e-01, -5.5575e-01,  4.5480e+00,
         -1.7758e+00, -2.0045e-02],
        [ 8.8216e-01, -2.1139e+00, -4.8999e+00,  3.8561e+00, -1.7758e+00,
          2.3490e+00,  6.7603e-01],
        [ 8.8332e-01, -2.7191e+00, -4.2765e+00,  1.8739e+00, -2.0045e-02,
          6.7603e-01,  1.9344e+00]], grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[ -0.7702,   2.5821,  -3.8938,   0.3245,   5.1040,  -1.4025,  -2.3098],
        [  2.6201,  -7.3016,   9.6489,  -1.4377, -14.5316,   0.8986,   9.9305],
        [  3.9471, -13.2457,  18.2255,  -3.6384, -25.3757,  -0.5805,  16.4493],
        [ -3.1750,   7.8701, -12.7909,   1.5248,  17.1675,  -1.6300, -10.3204],
        [ -0.0340,  -0.0663,   1.6814,  -0.1981,  -1.1744,  -0.8741,  -1.6047],
        [ -0.5119,   1.5531,  -3.5710,   0.3487,   3.1424,   0.1809,  -1.5775],
        [ -0.4098,   1.1231,  -2.3396,   0.4578,   2.1828,   0.2143,  -2.3373]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ 5.7426e+00, -4.8366e+01, -9.1881e+01,  5.1320e+01,  2.3811e+01,
          2.7328e-01,  4.0402e+00],
        [-7.8834e+00,  1.0887e+02,  2.1354e+02, -1.2360e+02, -6.2282e+01,
         -4.4703e-01, -1.6810e+00],
        [-3.1755e+01,  2.4109e+02,  4.6712e+02, -2.8023e+02, -1.0340e+02,
         -1.7032e+01, -1.3321e+01],
        [ 2.1172e+01, -1.7193e+02, -3.2652e+02,  1.9014e+02,  7.5815e+01,
          7.8250e+00,  1.1944e+01],
        [-1.3126e+01,  4.8460e+01,  8.5960e+01, -5.2491e+01, -3.7965e+00,
         -9.9453e+00, -1.1083e+01],
        [ 1.2812e+01, -6.1281e+01, -1.1490e+02,  6.9145e+01,  1.2979e+01,
          8.8859e+00,  8.2576e+00],
        [ 7.6796e+00, -3.8529e+01, -7.3212e+01,  4.5852e+01,  8.7364e+00,
          5.5408e+00,  3.0273e+00]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[   86.7999,  -719.4832, -1381.3431,  ...,   326.0612,    35.5057,
            43.3240],
        [  119.8205, -1005.3942, -1941.9713,  ...,   459.9661,    51.9956,
            51.9167],
        [  151.6237, -1206.4230, -2331.2363,  ...,   532.3474,    72.4768,
            65.7681],
        ...,
        [  161.6503, -1348.5420, -2599.3538,  ...,   614.9324,    67.6070,
            74.6897],
        [  153.5068, -1287.6216, -2486.1497,  ...,   589.6285,    64.8744,
            67.5350],
        [  132.4032, -1096.1317, -2105.2048,  ...,   496.8523,    53.4039,
            65.4590]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[-8.0658e+03,  6.5167e+04,  1.2543e+05, -7.4016e+04, -2.9073e+04,
         -3.5327e+03, -3.8391e+03],
        [ 2.4664e+04, -2.0483e+05, -3.9546e+05,  2.3386e+05,  9.2971e+04,
          1.0842e+04,  1.0900e+04],
        [ 4.3943e+04, -3.5767e+05, -6.9006e+05,  4.0861e+05,  1.6018e+05,
          1.9935e+04,  1.9728e+04],
        [-2.9539e+04,  2.4039e+05,  4.6324e+05, -2.7385e+05, -1.0757e+05,
         -1.3182e+04, -1.3596e+04],
        [ 1.7014e+03, -6.0697e+03, -1.0728e+04,  6.5022e+03,  3.1107e+02,
          1.2447e+03,  1.4241e+03],
        [-6.3478e+03,  4.7455e+04,  9.1029e+04, -5.3974e+04, -1.9903e+04,
         -3.1325e+03, -3.1887e+03],
        [-4.5118e+03,  3.6167e+04,  6.9829e+04, -4.1445e+04, -1.6008e+04,
         -2.1150e+03, -1.9752e+03]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[   4192.1606,  -34166.5547,  -65878.6250,  ...,   15310.6250,
            1879.8295,    1907.4683],
        [   6035.9937,  -49379.9727,  -95261.2578,  ...,   22187.4902,
            2705.9209,    2714.4597],
        [   7072.6802,  -57684.9414, -111279.4922,  ...,   25866.6641,
            3187.2722,    3184.0569],
        ...,
        [   7962.9951,  -64998.3906, -125362.7109,  ...,   29161.3887,
            3571.2192,    3601.6689],
        [   7680.7788,  -62796.4648, -121136.0938,  ...,   28205.5410,
            3441.6926,    3460.3193],
        [   6372.2612,  -51947.7852, -100166.5859,  ...,   23284.1641,
            2855.3823,    2897.8652]], grad_fn=<AddBackward0>)
x
tensor([[ 0.0049,  0.0488,  0.1160,  ..., -0.0207, -0.0060,  0.0012],
        [ 0.0063,  0.0489,  0.1174,  ..., -0.0195, -0.0052,  0.0009],
        [ 0.0055,  0.0531,  0.1196,  ..., -0.0138, -0.0063, -0.0017],
        ...,
        [ 0.0048,  0.0522,  0.1244,  ..., -0.0194, -0.0049, -0.0034],
        [ 0.0037,  0.0511,  0.1226,  ..., -0.0186, -0.0041, -0.0011],
        [ 0.0049,  0.0534,  0.1206,  ..., -0.0165, -0.0042, -0.0049]],
       grad_fn=<AddmmBackward>)
h0
tensor([[ 0.0049,  0.0488,  0.1160,  ..., -0.0207, -0.0060,  0.0012],
        [ 0.0063,  0.0489,  0.1174,  ..., -0.0195, -0.0052,  0.0009],
        [ 0.0055,  0.0531,  0.1196,  ..., -0.0138, -0.0063, -0.0017],
        ...,
        [ 0.0048,  0.0522,  0.1244,  ..., -0.0194, -0.0049, -0.0034],
        [ 0.0037,  0.0511,  0.1226,  ..., -0.0186, -0.0041, -0.0011],
        [ 0.0049,  0.0534,  0.1206,  ..., -0.0165, -0.0042, -0.0049]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 9.1396e-02,  7.0886e-01,  1.6602e+00, -9.1278e-01, -2.7124e-01,
         -7.1248e-02, -1.9887e-02],
        [ 7.0886e-01,  7.0532e+00,  1.6475e+01, -9.0530e+00, -2.6238e+00,
         -7.1502e-01, -1.7729e-01],
        [ 1.6602e+00,  1.6475e+01,  3.8564e+01, -2.1177e+01, -6.1379e+00,
         -1.6798e+00, -4.0561e-01],
        [-9.1278e-01, -9.0530e+00, -2.1177e+01,  1.1652e+01,  3.3700e+00,
          9.2461e-01,  2.1927e-01],
        [-2.7124e-01, -2.6238e+00, -6.1379e+00,  3.3700e+00,  1.0039e+00,
          2.6312e-01,  6.3420e-02],
        [-7.1248e-02, -7.1502e-01, -1.6798e+00,  9.2461e-01,  2.6312e-01,
          8.1305e-02,  1.8375e-02],
        [-1.9887e-02, -1.7729e-01, -4.0561e-01,  2.1927e-01,  6.3420e-02,
          1.8375e-02,  1.6926e-02]], grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[  0.0656,  -0.5101,   0.4002,  -0.1526,  -0.9739,  -0.3977,   0.4947],
        [  1.0760,  -4.4644,   5.3523,  -1.9689,  -8.1727,  -1.5839,   6.3607],
        [  2.5772, -10.3543,  12.7310,  -4.6826, -18.8892,  -3.3741,  15.1020],
        [ -1.4944,   5.5667,  -7.2298,   2.6484,  10.1092,   1.4495,  -8.5567],
        [ -0.4660,   1.5620,  -2.1929,   0.8027,   2.7970,   0.2374,  -2.6065],
        [ -0.1625,   0.3746,  -0.7170,   0.2571,   0.6411,  -0.1195,  -0.8323],
        [ -0.0769,   0.0298,  -0.2894,   0.1021,   0.0206,  -0.2193,  -0.3349]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[ 7.3086e-01,  7.1764e+00,  1.6817e+01, -9.2372e+00, -2.7013e+00,
         -7.3286e-01, -1.6737e-01],
        [ 9.8201e+00,  9.6729e+01,  2.2658e+02, -1.2446e+02, -3.6283e+01,
         -9.8581e+00, -2.2723e+00],
        [ 2.3370e+01,  2.3023e+02,  5.3929e+02, -2.9624e+02, -8.6346e+01,
         -2.3462e+01, -5.4104e+00],
        [-1.3286e+01, -1.3093e+02, -3.0668e+02,  1.6846e+02,  4.9088e+01,
          1.3340e+01,  3.0789e+00],
        [-4.0326e+00, -3.9756e+01, -9.3116e+01,  5.1151e+01,  1.4898e+01,
          4.0496e+00,  9.3546e-01],
        [-1.3231e+00, -1.3062e+01, -3.0589e+01,  1.6803e+01,  4.8876e+00,
          1.3295e+00,  3.0838e-01],
        [-5.4288e-01, -5.3746e+00, -1.2582e+01,  6.9119e+00,  2.0048e+00,
          5.4615e-01,  1.2763e-01]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[  -83.7286,  -824.9084, -1932.2280,  ...,   309.3411,    84.0553,
            19.3972],
        [  -84.4191,  -831.7665, -1948.2889,  ...,   311.9185,    84.7575,
            19.5569],
        [  -85.5222,  -842.5811, -1973.6523,  ...,   316.0050,    85.8572,
            19.8011],
        ...,
        [  -88.0214,  -867.1843, -2031.2527,  ...,   325.2069,    88.3694,
            20.3727],
        [  -85.9618,  -846.8483, -1983.6168,  ...,   317.5832,    86.2999,
            19.9034],
        [  -85.8164,  -845.4581, -1980.3892,  ...,   317.0732,    86.1587,
            19.8558]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[-1.1827e+03, -1.1653e+04, -2.7296e+04,  1.4994e+04,  4.3700e+03,
          1.1875e+03,  2.7386e+02],
        [-1.1731e+04, -1.1558e+05, -2.7073e+05,  1.4872e+05,  4.3344e+04,
          1.1778e+04,  2.7164e+03],
        [-2.7449e+04, -2.7044e+05, -6.3346e+05,  3.4797e+05,  1.0142e+05,
          2.7558e+04,  6.3559e+03],
        [ 1.5081e+04,  1.4858e+05,  3.4802e+05, -1.9117e+05, -5.5718e+04,
         -1.5140e+04, -3.4919e+03],
        [ 4.3711e+03,  4.3066e+04,  1.0088e+05, -5.5412e+04, -1.6150e+04,
         -4.3885e+03, -1.0121e+03],
        [ 1.1956e+03,  1.1779e+04,  2.7591e+04, -1.5156e+04, -4.4173e+03,
         -1.2003e+03, -2.7683e+02],
        [ 2.8866e+02,  2.8440e+03,  6.6618e+03, -3.6594e+03, -1.0666e+03,
         -2.8981e+02, -6.6791e+01]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[ -3134.3828, -30880.4199, -72333.2109,  ...,  11580.6025,
           3146.7739,    725.7659],
        [ -3161.2825, -31145.4492, -72954.0078,  ...,  11679.9951,
           3173.7803,    731.9944],
        [ -3204.0720, -31567.0117, -73941.4688,  ...,  11838.0889,
           3216.7388,    741.9008],
        ...,
        [ -3296.3396, -32476.0410, -76070.7422,  ...,  12178.9844,
           3309.3713,    763.2646],
        [ -3220.2856, -31726.7441, -74315.6094,  ...,  11897.9873,
           3233.0168,    745.6545],
        [ -3214.7024, -31671.7422, -74186.7812,  ...,  11877.3643,
           3227.4126,    744.3607]], grad_fn=<AddBackward0>)
Epoch: 0004 loss_train: 84091.6172 acc_train: 0.0786 loss_val: 57977.6133 acc_val: 0.0833 time: 0.0184s
x
tensor([[ 0.0100,  0.0346,  0.1270,  ...,  0.0233, -0.0200,  0.0114],
        [ 0.0392,  0.0309,  0.1547,  ..., -0.0489, -0.0003,  0.0389],
        [-0.0344,  0.0600,  0.2137,  ..., -0.0407,  0.0236, -0.0024],
        ...,
        [-0.0278,  0.1121,  0.1425,  ..., -0.1034,  0.0543,  0.0094],
        [ 0.0587,  0.0463,  0.0712,  ..., -0.0386, -0.0242,  0.0301],
        [-0.0110,  0.0719,  0.1635,  ...,  0.0276,  0.0099, -0.0057]],
       grad_fn=<AddmmBackward>)
h0
tensor([[ 0.0100,  0.0346,  0.1270,  ...,  0.0233, -0.0200,  0.0114],
        [ 0.0392,  0.0309,  0.1547,  ..., -0.0489, -0.0003,  0.0389],
        [-0.0344,  0.0600,  0.2137,  ..., -0.0407,  0.0236, -0.0024],
        ...,
        [-0.0278,  0.1121,  0.1425,  ..., -0.1034,  0.0543,  0.0094],
        [ 0.0587,  0.0463,  0.0712,  ..., -0.0386, -0.0242,  0.0301],
        [-0.0110,  0.0719,  0.1635,  ...,  0.0276,  0.0099, -0.0057]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[ 4.1452e+00,  2.2354e-02,  1.9732e+00, -8.5203e-02, -1.6984e+00,
         -1.8502e-02,  5.6580e-01],
        [ 2.2354e-02,  1.1145e+01,  1.7791e+01, -9.4450e+00, -3.9513e+00,
          5.8497e-01, -1.4117e+00],
        [ 1.9732e+00,  1.7791e+01,  4.2523e+01, -2.0194e+01, -6.0149e+00,
         -1.0678e+00, -1.6598e+00],
        [-8.5203e-02, -9.4450e+00, -2.0194e+01,  1.4788e+01,  2.0678e+00,
          1.4353e+00, -2.3879e-01],
        [-1.6984e+00, -3.9513e+00, -6.0149e+00,  2.0678e+00,  7.1673e+00,
         -2.2639e+00, -7.9609e-02],
        [-1.8502e-02,  5.8497e-01, -1.0678e+00,  1.4353e+00, -2.2639e+00,
          2.2905e+00,  1.1673e-01],
        [ 5.6580e-01, -1.4117e+00, -1.6598e+00, -2.3879e-01, -7.9609e-02,
          1.1673e-01,  2.3366e+00]], grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[  0.0646,   0.1941,  -0.7005,  -0.4417,   0.5448,  -1.8164,   1.2751],
        [  1.6145,  -4.7732,   5.0831,  -1.8386,  -9.0918,  -0.5318,   8.2944],
        [  2.5342, -11.3577,  13.5249,  -5.8216, -20.0402,  -4.7578,  16.7378],
        [ -1.9833,   4.8987,  -8.1512,   2.0657,  11.1797,   0.3620,  -8.0283],
        [ -0.4235,   1.5188,   0.6478,   0.4615,   1.1325,  -0.5312,  -4.4525],
        [ -0.0332,   0.2961,  -2.1261,   0.1365,   0.7183,   0.5229,   0.2429],
        [ -0.1094,   0.1212,  -1.2416,   0.3741,   0.4896,   0.4527,  -1.4827]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[  -1.2429,  -11.1410,  -20.7402,    3.9896,   10.3391,   -5.0188,
            3.7546],
        [  36.9166,   78.5407,  213.0278, -106.4328,  -82.8778,    9.4443,
           19.6967],
        [  81.0291,  221.8537,  593.4544, -304.4130, -187.0111,    6.9365,
           36.5593],
        [ -47.9085, -142.6064, -359.3964,  174.6053,  117.2605,  -10.8466,
          -14.6086],
        [  -4.9152,   25.5836,   45.5573,  -17.9229,    1.4496,   -3.4331,
          -14.1250],
        [  -5.4302,  -38.6898,  -93.2429,   44.3356,   15.9016,    2.2400,
            3.6307],
        [  -4.6115,  -23.8503,  -59.3766,   31.4846,   10.5505,    1.6911,
           -1.7123]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[ -348.9751,  -991.8232, -2588.2529,  ...,   825.0916,   -48.0775,
          -135.0995],
        [ -337.5381,  -872.9261, -2340.0088,  ...,   771.2297,   -42.4988,
          -160.0238],
        [ -436.8520, -1141.6821, -3054.1897,  ...,  1006.5508,   -57.9833,
          -203.8899],
        ...,
        [ -378.2334,  -894.3002, -2425.8894,  ...,   855.5347,   -67.0202,
          -197.4588],
        [ -223.6846,  -574.7652, -1533.1958,  ...,   509.8321,   -31.7479,
          -104.7178],
        [ -327.4045,  -886.3196, -2356.4993,  ...,   760.4284,   -38.4593,
          -143.9535]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[-3.2930e+03, -6.9850e+03, -2.0216e+04,  1.1079e+04,  6.6889e+03,
         -1.5369e+01, -2.2446e+03],
        [-4.6565e+04, -1.2153e+05, -3.2344e+05,  1.6394e+05,  1.0737e+05,
         -6.8675e+03, -2.1373e+04],
        [-1.0220e+05, -2.7225e+05, -7.2315e+05,  3.6688e+05,  2.3633e+05,
         -1.3756e+04, -4.5834e+04],
        [ 5.4203e+04,  1.4650e+05,  3.8661e+05, -1.9500e+05, -1.2630e+05,
          7.8764e+03,  2.3284e+04],
        [ 1.5049e+04,  3.2942e+04,  9.1514e+04, -4.7482e+04, -3.2987e+04,
          2.4461e+03,  8.8724e+03],
        [ 2.7102e+03,  1.0897e+04,  2.6959e+04, -1.3177e+04, -7.0829e+03,
          9.4302e+01,  1.6964e+02],
        [ 3.7400e+03,  1.0267e+04,  2.7291e+04, -1.3926e+04, -8.6330e+03,
          4.1264e+02,  1.7158e+03]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[ -13482.5947,  -36169.2539,  -95811.2969,  ...,   31279.2520,
           -1862.5079,   -5934.9751],
        [ -13846.8691,  -36644.6875,  -97412.6016,  ...,   31972.8809,
           -1904.5731,   -6262.7534],
        [ -17659.6699,  -46804.6641, -124372.7109,  ...,   40813.0938,
           -2441.5740,   -7963.4639],
        ...,
        [ -15694.0547,  -41141.5078, -109528.6484,  ...,   36176.1914,
           -2224.1270,   -7195.0332],
        [  -9139.4375,  -24178.2930,  -64251.9336,  ...,   21104.0000,
           -1267.8066,   -4129.0840],
        [ -13016.2021,  -34693.9883,  -92093.0469,  ...,   30125.7988,
           -1780.5245,   -5815.1719]], grad_fn=<AddBackward0>)
x
tensor([[ 0.0258,  0.0331,  0.1072,  ..., -0.0368,  0.0055,  0.0116],
        [ 0.0274,  0.0331,  0.1085,  ..., -0.0357,  0.0065,  0.0115],
        [ 0.0266,  0.0375,  0.1108,  ..., -0.0300,  0.0052,  0.0086],
        ...,
        [ 0.0260,  0.0367,  0.1160,  ..., -0.0357,  0.0066,  0.0067],
        [ 0.0248,  0.0355,  0.1142,  ..., -0.0350,  0.0074,  0.0090],
        [ 0.0260,  0.0378,  0.1121,  ..., -0.0328,  0.0072,  0.0052]],
       grad_fn=<AddmmBackward>)
h0
tensor([[ 0.0258,  0.0331,  0.1072,  ..., -0.0368,  0.0055,  0.0116],
        [ 0.0274,  0.0331,  0.1085,  ..., -0.0357,  0.0065,  0.0115],
        [ 0.0266,  0.0375,  0.1108,  ..., -0.0300,  0.0052,  0.0086],
        ...,
        [ 0.0260,  0.0367,  0.1160,  ..., -0.0357,  0.0066,  0.0067],
        [ 0.0248,  0.0355,  0.1142,  ..., -0.0350,  0.0074,  0.0090],
        [ 0.0260,  0.0378,  0.1121,  ..., -0.0328,  0.0072,  0.0052]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[  1.8834,   2.5104,   7.8699,  -3.4132,  -2.5176,   0.4507,   0.6375],
        [  2.5104,   3.3995,  10.6079,  -4.6022,  -3.3835,   0.6088,   0.8551],
        [  7.8699,  10.6079,  33.2475, -14.4078, -10.6010,   1.9000,   2.6964],
        [ -3.4132,  -4.6022, -14.4078,   6.2646,   4.5942,  -0.8222,  -1.1717],
        [ -2.5176,  -3.3835, -10.6010,   4.5942,   3.4092,  -0.6102,  -0.8623],
        [  0.4507,   0.6088,   1.9000,  -0.8222,  -0.6102,   0.1164,   0.1555],
        [  0.6375,   0.8551,   2.6964,  -1.1717,  -0.8623,   0.1555,   0.2331]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[  0.3210,  -1.9318,   1.3868,  -1.1753,  -3.0891,  -1.3933,   3.0467],
        [  0.4489,  -2.5830,   1.9300,  -1.6023,  -4.1128,  -1.7782,   4.1613],
        [  1.4933,  -7.9318,   6.3871,  -5.1501, -12.5013,  -5.0478,  13.3754],
        [ -0.7145,   3.3183,  -2.9995,   2.3115,   5.1678,   1.8212,  -6.0344],
        [ -0.5344,   2.4241,  -2.2366,   1.7149,   3.7436,   1.2743,  -4.4893],
        [  0.0441,  -0.5275,   0.2105,  -0.2407,  -0.8824,  -0.5244,   0.6109],
        [  0.0796,  -0.7206,   0.3679,  -0.3644,  -1.1787,  -0.6367,   0.9281]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[  19.7721,   26.5674,   83.3898,  -36.1648,  -26.6811,    4.7665,
            6.8267],
        [  27.2250,   36.5845,  114.8271,  -49.7985,  -36.7362,    6.5641,
            9.3992],
        [  88.4714,  118.9027,  373.1717, -161.8376, -119.3659,   21.3353,
           30.5403],
        [ -40.5478,  -54.5057, -171.0465,   74.1793,   54.6986,   -9.7814,
          -13.9944],
        [ -30.0888,  -40.4478, -126.9289,   55.0466,   40.5881,   -7.2588,
          -10.3847],
        [   3.6116,    4.8467,   15.2226,   -6.6020,   -4.8785,    0.8690,
            1.2484],
        [   5.7520,    7.7235,   24.2510,  -10.5174,   -7.7662,    1.3852,
            1.9872]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[ -282.6928,  -379.9457, -1192.4170,  ...,   381.3948,   -68.1785,
           -97.5727],
        [ -285.2793,  -383.4299, -1203.3475,  ...,   384.8977,   -68.7996,
           -98.4680],
        [ -286.6821,  -385.2922, -1209.2402,  ...,   386.8096,   -69.1421,
           -98.9631],
        ...,
        [ -298.4993,  -401.1749, -1259.0558,  ...,   402.7263,   -71.9861,
          -103.0487],
        [ -291.2796,  -391.4693, -1228.5885,  ...,   392.9828,   -70.2404,
          -100.5459],
        [ -288.8227,  -388.1649, -1218.2544,  ...,   389.6832,   -69.6497,
           -99.7145]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[ -20418.2969,  -27442.1992,  -86125.4219,   37350.9766,   27548.0488,
           -4924.1689,   -7048.3027],
        [ -27514.3203,  -36979.0430, -116056.3125,   50331.4414,   37121.7734,
           -6635.4443,   -9497.7930],
        [ -86196.6016, -115847.7656, -363580.1562,  157677.9375,  116294.7422,
          -20787.4883,  -29754.5332],
        [  37374.7422,   50231.4336,  157647.9531,  -68368.9141,  -50425.2773,
            9013.4375,   12901.5195],
        [  27506.0352,   36968.0078,  116021.5078,  -50316.3672,  -37110.5234,
            6633.4468,    9494.9121],
        [  -4930.1357,   -6626.0698,  -20795.4902,    9018.6230,    6651.6304,
           -1188.9391,   -1701.8484],
        [  -6993.5166,   -9399.2666,  -29498.8809,   12793.1016,    9435.5029,
           -1686.5762,   -2414.0601]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[ -8788.5234, -11811.7285, -37070.2930,  ...,  11857.2979,
          -2119.4724,  -3033.7417],
        [ -8872.6367, -11924.7773, -37425.0938,  ...,  11970.7881,
          -2139.7588,  -3062.7788],
        [ -8923.2002, -11992.7334, -37638.3633,  ...,  12039.0068,
          -2151.9519,  -3080.2339],
        ...,
        [ -9283.9736, -12477.6094, -39160.1172,  ...,  12525.7510,
          -2238.9568,  -3204.7710],
        [ -9065.0850, -12183.4248, -38236.8359,  ...,  12230.4336,
          -2186.1682,  -3129.2122],
        [ -8988.1670, -12080.0449, -37912.3945,  ...,  12126.6562,
          -2167.6187,  -3102.6619]], grad_fn=<AddBackward0>)
Epoch: 0005 loss_train: 66183.0781 acc_train: 0.0786 loss_val: 25081.0859 acc_val: 0.0833 time: 0.0182s
Optimization Finished!
Total time elapsed: 0.1463s
x
tensor([[ 0.0258,  0.0331,  0.1072,  ..., -0.0368,  0.0055,  0.0116],
        [ 0.0274,  0.0331,  0.1085,  ..., -0.0357,  0.0065,  0.0115],
        [ 0.0266,  0.0375,  0.1108,  ..., -0.0300,  0.0052,  0.0086],
        ...,
        [ 0.0260,  0.0367,  0.1160,  ..., -0.0357,  0.0066,  0.0067],
        [ 0.0248,  0.0355,  0.1142,  ..., -0.0350,  0.0074,  0.0090],
        [ 0.0260,  0.0378,  0.1121,  ..., -0.0328,  0.0072,  0.0052]],
       grad_fn=<AddmmBackward>)
h0
tensor([[ 0.0258,  0.0331,  0.1072,  ..., -0.0368,  0.0055,  0.0116],
        [ 0.0274,  0.0331,  0.1085,  ..., -0.0357,  0.0065,  0.0115],
        [ 0.0266,  0.0375,  0.1108,  ..., -0.0300,  0.0052,  0.0086],
        ...,
        [ 0.0260,  0.0367,  0.1160,  ..., -0.0357,  0.0066,  0.0067],
        [ 0.0248,  0.0355,  0.1142,  ..., -0.0350,  0.0074,  0.0090],
        [ 0.0260,  0.0378,  0.1121,  ..., -0.0328,  0.0072,  0.0052]],
       grad_fn=<AddmmBackward>)
adj
tensor(indices=tensor([[   0,    8,   14,  ..., 1389, 2344, 2707],
                       [   0,    0,    0,  ..., 2707, 2707, 2707]]),
       values=tensor([0.1667, 0.1667, 0.0500,  ..., 0.2000, 0.5000, 0.2500]),
       size=(2708, 2708), nnz=13264, layout=torch.sparse_coo)
alpha:  0.1 beta 0.1 gamma 0.2
coe = 1.0 / (self.alpha + self.beta)
5.0
coe1 = 1 - self.gamma
0.8
coe2 = 1.0 / coe1
1.25
res = torch.mm(torch.transpose(x, 0, 1), x)
tensor([[  1.8834,   2.5104,   7.8699,  -3.4132,  -2.5176,   0.4507,   0.6375],
        [  2.5104,   3.3995,  10.6079,  -4.6022,  -3.3835,   0.6088,   0.8551],
        [  7.8699,  10.6079,  33.2475, -14.4078, -10.6010,   1.9000,   2.6964],
        [ -3.4132,  -4.6022, -14.4078,   6.2646,   4.5942,  -0.8222,  -1.1717],
        [ -2.5176,  -3.3835, -10.6010,   4.5942,   3.4092,  -0.6102,  -0.8623],
        [  0.4507,   0.6088,   1.9000,  -0.8222,  -0.6102,   0.1164,   0.1555],
        [  0.6375,   0.8551,   2.6964,  -1.1717,  -0.8623,   0.1555,   0.2331]],
       grad_fn=<MmBackward>)
inv = self.fc3(res)
tensor([[  0.3210,  -1.9318,   1.3868,  -1.1753,  -3.0891,  -1.3933,   3.0467],
        [  0.4489,  -2.5830,   1.9300,  -1.6023,  -4.1128,  -1.7782,   4.1613],
        [  1.4933,  -7.9318,   6.3871,  -5.1501, -12.5013,  -5.0478,  13.3754],
        [ -0.7145,   3.3183,  -2.9995,   2.3115,   5.1678,   1.8212,  -6.0344],
        [ -0.5344,   2.4241,  -2.2366,   1.7149,   3.7436,   1.2743,  -4.4893],
        [  0.0441,  -0.5275,   0.2105,  -0.2407,  -0.8824,  -0.5244,   0.6109],
        [  0.0796,  -0.7206,   0.3679,  -0.3644,  -1.1787,  -0.6367,   0.9281]],
       grad_fn=<AddmmBackward>)
res = torch.mm(inv, res)
tensor([[  19.7721,   26.5674,   83.3898,  -36.1648,  -26.6811,    4.7665,
            6.8267],
        [  27.2250,   36.5845,  114.8271,  -49.7985,  -36.7362,    6.5641,
            9.3992],
        [  88.4714,  118.9027,  373.1717, -161.8376, -119.3659,   21.3353,
           30.5403],
        [ -40.5478,  -54.5057, -171.0465,   74.1793,   54.6986,   -9.7814,
          -13.9944],
        [ -30.0888,  -40.4478, -126.9289,   55.0466,   40.5881,   -7.2588,
          -10.3847],
        [   3.6116,    4.8467,   15.2226,   -6.6020,   -4.8785,    0.8690,
            1.2484],
        [   5.7520,    7.7235,   24.2510,  -10.5174,   -7.7662,    1.3852,
            1.9872]], grad_fn=<MmBackward>)
res = coe1 * coe * x - coe1 * coe * coe * torch.mm(x, res)
tensor([[ -282.6928,  -379.9457, -1192.4170,  ...,   381.3948,   -68.1785,
           -97.5727],
        [ -285.2793,  -383.4299, -1203.3475,  ...,   384.8977,   -68.7996,
           -98.4680],
        [ -286.6821,  -385.2922, -1209.2402,  ...,   386.8096,   -69.1421,
           -98.9631],
        ...,
        [ -298.4993,  -401.1749, -1259.0558,  ...,   402.7263,   -71.9861,
          -103.0487],
        [ -291.2796,  -391.4693, -1228.5885,  ...,   392.9828,   -70.2404,
          -100.5459],
        [ -288.8227,  -388.1649, -1218.2544,  ...,   389.6832,   -69.6497,
           -99.7145]], grad_fn=<SubBackward0>)
tmp = torch.mm(torch.transpose(x, 0, 1), res)
tensor([[ -20418.2969,  -27442.1992,  -86125.4219,   37350.9766,   27548.0488,
           -4924.1689,   -7048.3027],
        [ -27514.3203,  -36979.0430, -116056.3125,   50331.4414,   37121.7734,
           -6635.4443,   -9497.7930],
        [ -86196.6016, -115847.7656, -363580.1562,  157677.9375,  116294.7422,
          -20787.4883,  -29754.5332],
        [  37374.7422,   50231.4336,  157647.9531,  -68368.9141,  -50425.2773,
            9013.4375,   12901.5195],
        [  27506.0352,   36968.0078,  116021.5078,  -50316.3672,  -37110.5234,
            6633.4468,    9494.9121],
        [  -4930.1357,   -6626.0698,  -20795.4902,    9018.6230,    6651.6304,
           -1188.9391,   -1701.8484],
        [  -6993.5166,   -9399.2666,  -29498.8809,   12793.1016,    9435.5029,
           -1686.5762,   -2414.0601]], grad_fn=<MmBackward>)
 res = coe1 * torch.mm(x, tmp) + self.beta * torch.spmm(adj, res) -             self.gamma * coe1 * torch.mm(h0, tmp) + self.gamma * h0
tensor([[ -8788.5234, -11811.7285, -37070.2930,  ...,  11857.2979,
          -2119.4724,  -3033.7417],
        [ -8872.6367, -11924.7773, -37425.0938,  ...,  11970.7881,
          -2139.7588,  -3062.7788],
        [ -8923.2002, -11992.7334, -37638.3633,  ...,  12039.0068,
          -2151.9519,  -3080.2339],
        ...,
        [ -9283.9736, -12477.6094, -39160.1172,  ...,  12525.7510,
          -2238.9568,  -3204.7710],
        [ -9065.0850, -12183.4248, -38236.8359,  ...,  12230.4336,
          -2186.1682,  -3129.2122],
        [ -8988.1670, -12080.0449, -37912.3945,  ...,  12126.6562,
          -2167.6187,  -3102.6619]], grad_fn=<AddBackward0>)
Test set results: loss= 22310.2852 accuracy= 0.1590
